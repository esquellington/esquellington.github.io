<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>That time I saw a weird rainbow</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="../css/simple.min.css" /><link rel="stylesheet" href="../css/custom.css" />
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<header id="top" class="status">
<style>
  /* Customize Simple.css <header> padding top/bottom and left/right
     NOTE: this affects <footer> too, seems unavoidable
   */
  .status { padding: 20px 20px; }
  /* Container grid for 3 header elements */
  .container_img_title_icons { width: 100%;
                               display: grid;
                               grid-template-columns: 20% 50% 30%; }
  /* Container grid for 3 icons */
  .container_icons { display: grid;
                     grid-template-columns: 25% 25% 25% 25%; }
  /* SVG icon from fontawesome https://docs.fontawesome.com/web/add-icons/svg-bare
     fill: white, instead of default black TODO: dark mode only!?)
  */
  .icon { width: 2em;
          height: 2em;
          fill: black;
          vertical-align: -0.25em; }
  /* Change icon color when hovered */
  .icon:hover { fill: turquoise; }

  /* Change icon fill+hover in dark scheme */
  @media (prefers-color-scheme: dark) {
      .icon { fill: white; }
      .icon:hover { fill: orange; }
  }

</style>

<div class="wrapper_header"> <!-- unnecessary -->

<div class="container_img_title_icons">

  <!-- Image on the Left-->
  <div>
    <a href="/">
      <img class="logo" type="image/gif" src="img/FireExecutioner.png"/>
    </a>
  </div>

  <!-- Title at Middle (empty now, but DIV to insert middle block) -->
  <div> </div>

  <!-- Icons on the Right -->
  <div class="container_icons">

    <div>
    <a href="https://mastodon.gamedev.place/@ocivitf" ><svg
    class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448
    512"><!--!Font Awesome Free 6.7.1 by @fontawesome -
    https://fontawesome.com License -
    https://fontawesome.com/license/free Copyright 2024 Fonticons,
    Inc.--><path d="M433
    179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0
    0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7
    75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3
    11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54a102.5 102.5 0 0 1
    -.9-13.9c85.6 20.9 158.7 9.1 178.8 6.7 56.1-6.7 105-41.3
    111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1
    125.2h-46.6v-114.2c0-49.7-64-51.6-64
    6.9v62.5h-46.3V197c0-58.5-64-56.6-64-6.9v114.2H90.2c0-122.1-5.2-147.9
    18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5
    11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4
    175z"/></svg></a>
    </div>

    <div>
    <a href="https://github.com/esquellington"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--!Font
    Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License
    - https://fontawesome.com/license/free Copyright 2024 Fonticons,
    Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3
    .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6
    3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0
    6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9
    2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6
    4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9
    69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1
    0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0
    0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9
    20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5
    7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27
    20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7
    34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9
    104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0
    6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5
    8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1
    1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9
    2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3
    .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3
    .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0
    5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9
    0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></a>
    </div>

    <div>
    <a href="https://draven.itch.io/"> <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font
    Awesome Free v7.0.1 by @fontawesome - https://fontawesome.com
    License - https://fontawesome.com/license/free Copyright 2025
    Fonticons, Inc.--><path d="M71.9 34.8C50.2 47.7 7.4 96.8 7 109.7l0
    21.3c0 27.1 25.3 50.8 48.2 50.8 27.6 0 50.5-22.8 50.5-50 0 27.1
    22.2 50 49.8 50s49-22.8 49-50c0 27.1 23.6 50 51.2 50l.5 0c27.6 0
    51.2-22.8 51.2-50 0 27.1 21.5 50 49 50s49.8-22.8 49.8-50c0 27.1 23
    50 50.5 50 23 0 48.3-23.8
    48.3-50.8l0-21.3c-.4-12.9-43.2-62.1-64.9-75-67.4-2.3-114.2-2.7-184-2.7S91.1
    33.1 71.9 34.8zM204.2 169.2c-22 38.4-77.9 38.7-99.8 .2-13.2
    23.1-43.2 32.1-56 27.7-3.9 40.2-13.7 237.1 17.7 269.2 80 18.7
    302.1 18.1 379.8 0 31.6-32.3 21.3-232 17.7-269.2-12.9
    4.4-42.9-4.6-56-27.7-22 38.5-77.8 38.1-99.8-.2-7.1 12.5-23
    28.9-51.8 28.9-10.4 .3-20.8-2.2-29.9-7.3s-16.7-12.6-21.9-21.6l0
    0zm-41.6 53.8c16.5 0 31.1 0 49.2 19.8 29.3-3 58.9-3 88.2 0
    18.2-19.7 32.8-19.7 49.2-19.7 52.3 0 65.2 77.5 83.9 144.4 17.3
    62.2-5.5 63.7-34 63.7-42.1-1.6-65.5-32.2-65.5-62.8-39.3 6.4-101.9
    8.8-155.6 0 0 30.6-23.3 61.2-65.5 62.8-28.4-.1-51.2-1.6-33.9-63.7
    18.7-67 31.6-144.4 83.9-144.4l0-.1zM256 270.8s-44.4 40.8-52.4
    55.2l29-1.2 0 25.3c0 1.5 21.3 .2 23.3 .2 11.6 .5 23.3 1
    23.3-.2l0-25.3 29 1.2c-8-14.5-52.4-55.2-52.4-55.2l.1 0z"/></svg></a>
    </div>

    <div>
    <a href="https://RSS"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font
    Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License
    - https://fontawesome.com/license/free Copyright 2024 Fonticons,
    Inc.--><path d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64
    64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM96
    136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24
    24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0
    96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24
    24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0
    120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg></a>
    </div>

  </div> <!-- container_icons -->

</div> <!-- container_img_title_icons -->

<!-- Top simple.css navigation buttons -->
<nav>
  <a class="button" href="/">Home</a>
  <a class="button" href="posts.html">Posts</a>
  <a class="button" href="/about">About</a>
</nav>

</div> <!-- wrapper_header -->
</header>
<main id="content" class="content">
<h1 class="title">That time I saw a weird rainbow</h1>
<p>
In May 2019 I saw this mysterious rainbow over Edinburgh. At first
sight it may look like a common double rainbow, but if you focus on
the bases you can see that they intersect.
</p>


<div id="orgaa89d7b" class="figure">
<p><img src="../img/Rainbow/Rainbow-2019-05-22-RETALLAT.jpeg" alt="Weird Rainbow" width="75%" />
</p>
</div>

<p>
Double rainbows are concentric, so they're not supposed to
intersect&#x2026;  there was definitely something else going on, so I
started reading to find out exactly what. It was a fun trip and I
ended up with satisfying answer (<a href="#org7db713d">spoiler</a>) and a new <a href="#org5a437e7">question</a>.
</p>

<p>
<i>(NB: All pictures mine unless source explicitly stated)</i>
</p>

<div id="outline-container-orgf86a85a" class="outline-2">
<h2 id="orgf86a85a">Rain-bows-tiary</h2>
<div class="outline-text-2" id="text-orgf86a85a">
<p>
After this terrible pun, let's have a quick look at the different
kinds of rainbows that have been observed and studied, and try to
classify the one in the picture above.
</p>
</div>

<div id="outline-container-orgaa653c6" class="outline-3">
<h3 id="orgaa653c6">Single rainbow</h3>
<div class="outline-text-3" id="text-orgaa653c6">
<p>
A single <b>primary</b> bow can be seen when sunlight rays are refracted
once inside raindrops, split into different wavelengths (colours) and
travel towards the observer standing between the Sun and the
rainbow. Rays exit the droplet at an angle of <i>42 degrees</i> downwards
relative to the original sunlight direction, as depicted below
(Source: <a href="https://upload.wikimedia.org/wikipedia/commons/7/70/Rainbow1.svg">Wikipedia Commons</a>)
</p>


<div id="org8828b3d" class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/7/70/Rainbow1.svg" alt="Refraction and reflection in a raindrop" class="org-svg" width="50%" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd6bb919" class="outline-3">
<h3 id="orgd6bb919">Concentric rainbows</h3>
<div class="outline-text-3" id="text-orgd6bb919">
<p>
Single rainbows are awesome on their own, but sometimes they're
accompained by additional concentric bows:
</p>
<ul class="org-ul">
<li>A <b>secondary</b> bow can appear around the primary one, caused by a
second refraction of sunlight inside rain droplets. The secondary bow
is concentric to primary one, appears approximately <i>10 degrees</i>
outside, is significantly fainter and its colors are
reversed. Primary + secondary form the relatively common "double
rainbow" that everybody loves. More details <a href="https://www.atoptics.co.uk/rainbows/sec.htm">here</a>.</li>
<li>Supernumerary bows can appear adjacent to the inside of any bow and
seem to repeat the same color pattern, but compressed. They are
caused by lightwave interference, which is awesome, but we won't dig
any deeper for now. More details <a href="https://www.atoptics.co.uk/rainbows/supers.htm">here</a>.</li>
</ul>

<p>
The picture below shows a faint secondary bow above the primary one,
and part of a supernumerary right below the primary violet shade.
</p>

<div id="orgc2c6386" class="figure">
<p><img src="../img/Rainbow/Rainbow-2019-10-29-Super.jpg" alt="Double Rainbow with supernumerary" width="90%" />
</p>
</div>

<p>
These are very cool, but definitely not what I saw.
</p>
</div>
</div>

<div id="outline-container-orgc1acece" class="outline-3">
<h3 id="orgc1acece">Reflection rainbows</h3>
<div class="outline-text-3" id="text-orgc1acece">
<p>
Reflection rainbows are formed by two separate bows: a primary one
caused by direct sunlight, and a <b>reflection</b> one above the primary,
caused by sunlight reflected on a water surface that must be behind
the observer, and calm enough for sunlight to reflect in a coherent
direction instead of scattering. The reflection bow is not concentric,
and appears above the primary one. More details <a href="https://www.atoptics.co.uk/rainbows/bowim6.htm">here</a>.
</p>
</div>
</div>

<div id="outline-container-orge26a12b" class="outline-3">
<h3 id="orge26a12b">Twinned rainbows</h3>
<div class="outline-text-3" id="text-orge26a12b">
<p>
Twinned rainbows are very rare, and apparently not yet fully
understood. A possible explanation is that they're primary bows that
bifurcate in some sections due to the presence of larger droplets that
become non-spherical under the effect of air friction, and refract
light in a slightly different direction, so the rays that reach the
observer come from slightly above/below the primary bow. More details
<a href="https://www.atoptics.co.uk/rainbows/bowim28.htm">here</a>.
</p>

<p>
The picture below shows a twinned primary bow and secondary bow above
it (Source: <a href="https://commons.wikimedia.org/wiki/File:Alexander%E2%80%99s_band_will_1.jpg">Wikimedia Commons</a>)
</p>


<div id="org1b97cda" class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Alexander%E2%80%99s_band_will_1.jpg/800px-Alexander%E2%80%99s_band_will_1.jpg" alt="Twinned Rainbow" width="90%" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org7db713d" class="outline-2">
<h2 id="org7db713d">So, what did I see?</h2>
<div class="outline-text-2" id="text-org7db713d">
<p>
Given that the 2 bows in my picture were not concentric they could
only be a twinned primary bow, or a pair of primary and reflection
bows. I very much suspected it was the latter but I had no proof. A
sane person would have probably stopped there. I didn't.
</p>

<p>
My shamelessly biased starting assumption was: <i>If I can prove that a
reflection bow was very likely, then it probably was, given how rare
twinned bows seem to be, and how hard it would be to prove that it was
a twinned bow instead</i>.
</p>

<p>
So yeah, I essentially looked for my keys under the <a href="https://en.wikipedia.org/wiki/Streetlight_effect">streetlight</a>, not
where I had probably lost them. The good news is that using my
picture, some basic trigonometry and publically available maps and
astronomical data, I arrived at a pretty convincing answer: The top
bow in the picture matches a predicted <b>reflection bow</b> with
surprising accuracy (97%), so it most likely was. Below I'll detail
how I arrived at this conclusion.
</p>

<p>
I unitaterally decided had to answer these 2 questions:
</p>
<ol class="org-ol">
<li><i>Is there a water surface where the Sun may have reflected?</i></li>
<li><i>Does the separation between primary and reflection bows in the
picture match the expected value, given the Sun elevation at that
time?</i></li>
</ol>

<p>
The first one was relatively easy, I knew that the Firth of Forth was
somewhere behind the camera, but not exactly where, so I had to find
out. The second one was harder, because the bow separation changes
along the arcs. We'd ideally analyze the vertical separation at the
apex, but the bows were not complete, they faded out outside the
picture.
</p>
</div>

<div id="outline-container-org3a48dff" class="outline-4">
<h4 id="org3a48dff">Sun, Camera and Water</h4>
<div class="outline-text-4" id="text-org3a48dff">
<p>
I was lucky to find the <a href="https://www.suncalc.org/#/55.9316,-3.1718,11/2019.05.21/21:00/1/3">SunCalc</a> site, and used it to generate a map of
the area that includes the Sun configuration relative to the camera
position at the time of observation (21/05/2019 21:00).
</p>


<div id="orgfbdbbe9" class="figure">
<p><img src="../img/Rainbow/Rainbow-2019-05-22-SunConfig.png" alt="SunConfig" width="90%" />
</p>
</div>

<p>
This image answers question 1, and provides data that will help answer
question 2:
</p>
<ul class="org-ul">
<li>The Sun direction matched the observed rainbow orientation, with an
altitude of \(2.7\) degrees above the horizon.</li>
<li>There was a large water body that extends from
\([10\text{km},16.5\text{km}]\) behind the camera, the Firth of Forth.</li>
</ul>

<p>
Assuming a perfect mirror water surface, we can infer that if the Sun
rays that caused the primary bow hit the raindrops with an angle of
\({\color[RGB]{247,189,0} \alpha_p} = -2.7\) deg, then their specular
reflection on the water that caused the reflection bow hit the rain
droplets at an angle of \({\color[RGB]{0,126,225} \alpha_r} = +2.7\)
deg.
</p>
</div>
</div>

<div id="outline-container-orgdf7adb9" class="outline-4">
<h4 id="orgdf7adb9">Reconstructing the full bows from a partial picture</h4>
<div class="outline-text-4" id="text-orgdf7adb9">
<p>
I needed the apex heights of the primary and reflection bows, but they
were incomplete, so I manually reconstructed the full bows from the
partial picture, by mirroring it horizontally, inverting the colors to
improve contrast, and matching a circle to each bow using
<a href="https://inkscape.org/">Inkscape</a>. This is obviously an approximation, but the conclusion seems
to prove it was good enough, so hooray for scrappy Science.
</p>


<div id="org6e443b4" class="figure">
<p><img src="../img/Rainbow/Rainbow-2019-05-22-RECONSTRUIT.png" alt="Reconstructed bows" width="90%" />
</p>
</div>

<p>
From this picture I computed the heights in pixels:
\({\color[RGB]{247,189,0} y_p} = 242\) px (primary) and
\({\color[RGB]{0,126,225} y_r} = 284\) px (reflection). I did not count
the pixels one by one, I promise.
</p>
</div>
</div>

<div id="outline-container-org6c8648d" class="outline-4">
<h4 id="org6c8648d">Identifying a reflection bow from known angles and heights</h4>
<div class="outline-text-4" id="text-org6c8648d">
<p>
The diagram below shows primary bow data in orange and reflection bow
data in blue. Reflection triangle angles are \(A=2.7\), \(B=135.3\), \(C=42\).
</p>


<div id="org8ca214e" class="figure">
<p><img src="../img/Rainbow/Rainbow_Angles.svg" alt="Angles" class="org-svg" width="100%" />
</p>
</div>

<p>
The next diagram zooms on the observer-horizon-bow triangles on the
right of the observer (origin). View angles above the horizon are
\({\color[RGB]{247,189,0} \theta_p} = 39.3\) and
\({\color[RGB]{0,126,225} \theta_r} = 44.7\), computed from the known
light-eye droplet reflection angle \(42\) and the Sun and reflection
elevations \({\color[RGB]{247,189,0} \alpha_p} = -2.7\) and
\({\color[RGB]{0,126,225} \alpha_r} =2.7\).
</p>

<div id="org5e851b0" class="figure">
<p><img src="../img/Rainbow/Rainbow_Angles_Zoomed.svg" alt="Distance and Height" class="org-svg" width="50%" />
</p>
</div>

<p>
Observer distances along the horizon (x-axis) to the primary and
reflection bows are unknown, but assumed to be equal
\({\color[RGB]{247,189,0} x_p} = {\color[RGB]{0,126,225} x_r} = x\),
as they were most likely caused by the same curtain of raindrops.
</p>

<p>
Assuming bow apex heights in the picture are perpendicular to the
horizon (y-axis), we have 2 rectangle triangles
</p>
\begin{eqnarray*}
  \tan( {\color[RGB]{0,126,225} \theta_r} ) = {\color[RGB]{0,126,225} y_r} / x \\
  \tan( {\color[RGB]{247,189,0} \theta_p} ) = {\color[RGB]{247,189,0} y_p} / x
\end{eqnarray*}

<p>
we can get rid of the unknown \(x\) easily by dividing the 2 equations
</p>

<p>
\[\frac{\tan( {\color[RGB]{0,126,225} \theta_r} )}{\tan( {\color[RGB]{247,189,0} \theta_p} )} =
\frac{ {\color[RGB]{0,126,225} y_r} }{ {\color[RGB]{247,189,0} y_p} }\]
</p>

<p>
and substituting known values on both sides we arrive at the approximate equality
\[1.209 \approx 1.173\]
with a relative error off \(3\%\), or an accuracy of \(97\%\), not too bad!
</p>
</div>
</div>

<div id="outline-container-orga682dd8" class="outline-4">
<h4 id="orga682dd8">Are we done? I don't think so&#x2026;</h4>
<div class="outline-text-4" id="text-orga682dd8">
<p>
We have our answer, but it's slightly unsatisfying. In particular, we
used known angles, but we did not need to consider the distance to the
water at all&#x2026; Maybe we can use it to validate or disprove the
conclusion?
</p>

<p>
One idea is to compute <i>how high is the rainbow?</i> and verify the
answer is reasonable. Clouds at Edinburgh's latitude extend between
roughly 500m to 10km above the sea (details later). If we compute the
height and it's significantly outside that range we'd need to
reconsider.
</p>
</div>
</div>

<div id="outline-container-org1ee4f69" class="outline-4">
<h4 id="org1ee4f69"><a id="org5a437e7"></a> How <del>high</del> <b>far</b> is the rainbow?</h4>
<div class="outline-text-4" id="text-org1ee4f69">
<p>
From the reconstructed picture we know the bow heights in <i>pixels</i>,
but not in <i>meters</i>. It turns out that with the data we have it's
easier to first compute the observer distance to the rainbow
\({\color[RGB]{0,126,225} d_r}\) rather than its height
\({\color[RGB]{0,126,225} y_r}\) over the horizon&#x2026; This is worth
mentioning because, in general, the distance to a single primary bow
cannot be known: it could be anywhere along the viewing direction, and
we have no additional data required to triangulate its height (details
<a href="https://www.atoptics.co.uk/fz439.hth">here</a>).
</p>

<p>
Fortunately, we know the distance range to the water reflection that
causes the reflection bow \(c=[10,16.5]\text{km}\), so we can compute
its height \({\color[RGB]{0,126,225} y_r}\) as follows.
</p>

<p>
Using the <a href="https://en.wikipedia.org/wiki/Law_of_sines">law of sines</a>
\[
  \frac{a}{\sin(A)} = \frac{b}{\sin(B)} = \frac{c}{\sin(C)}
\]
</p>

<p>
we isolate \({\color[RGB]{0,126,225} d_r} = a\) and obtain a distance range
\[
{\color[RGB]{0,126,225} d_r} = c \frac{\sin(A)}{\sin(C)} =
[10,16.5] \times 0.0704 = [0.7,1.16] \text{km}
\]
</p>

<p>
and using \({\color[RGB]{0,126,225} d_r}\) and the view angle
\({\color[RGB]{0,126,225} \theta_r}\) we obtain a height range
</p>

<p>
\[
{\color[RGB]{0,126,225} y_r}
= {\color[RGB]{0,126,225} d_r}\sin({\color[RGB]{0,126,225} \theta_r}) = [0.7,1.16] \times 0.703
= [0.492,0.816] \text{km}
\]
</p>

<p>
This range between roughly 500m to 800m is within the expected values
for low clouds, from 500m to 3km (<a href="https://www.weather.gov/key/low_clouds">details</a>). The clouds in the picture
did look pretty low indeed, as usual in Edinburgh, so I'm finally
convinced: I saw a reflection rainbow, and my lost keys were under the
streetlight.
</p>
</div>
</div>
</div>

<div id="outline-container-org215d90d" class="outline-2">
<h2 id="org215d90d">References</h2>
<div class="outline-text-2" id="text-org215d90d">
<ul class="org-ul">
<li>The <a href="https://atoptics.co.uk/">Atmospheric Optics</a> website is a great reference for learning
about rainbows and other phenomena.</li>
<li>The Wikipedia entry on <a href="https://en.wikipedia.org/wiki/Rainbow">Rainbow</a> is pretty exhaustive, I've linked a
few pictures from there.</li>
<li>This paper <a href="https://cs.dartmouth.edu/~wjarosz/publications/sadeghi11physically.html">Physically-based simulation of rainbows</a> explains and
computationally reproduces several kinds of rainbows, including
secondary bows, supernumeraries and twinned bows. It's worth a read.</li>
</ul>
</div>
</div>
</main>
<footer id="postamble" class="status">
<style>
  /* Customize Simple.css footer padding top/bottom and left/right */
</style>

<div class="footer">
  <div class="bg">
    <div class="container">
      Made with
      <a href="https://www.gnu.org/savannah-checkouts/gnu/emacs/emacs.html">Emacs</a>
      <!-- <img class="github" type="image/png" src="../img/Emacs.png" /> -->
      +
      <a href="https://orgmode.org/">Org Mode</a>
      <!-- <img class="github" type="image/png" src="../img/OrgMode.png" /> -->
      +
      <a href="https://simplecss.org/">Simple.css</a>
    </div>
  </div>
</div>
</footer>
</body>
</html>
